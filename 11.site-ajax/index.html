<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>

    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">

    <title>Cursos Online</title>

</head>
<body>
    <!-- Cabeçalho do site -->
    <header class="text-center">
        <img src="img/logo.png" alt="Logo do site" height="160"/>
    </header>

    <!-- Grupo de conteúdo -->
    <section class="p-5 text-center bg-primary text-light">
        <!-- 1vw = 1% da largura da janela 
        Se a janela de visualização tiver 50 cm de largura, 1vw será de 0,5 cm.
        -->
        <h2 style="font-size:4vw;">O melhor site de livros online</h2>
    </section>

    <!-- class="container-fluid -->
    <main class="container">
        <ul class="nav">
            <li class="nav-item">
              <a class="nav-link active" href="index.html">Inicio</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="cadastro.html">Cadastro</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Novidades</a>
            </li>
            <li class="nav-item">
              <a class="nav-link disabled" href="#">Sobre</a>
            </li>
          </ul>
        <div id="livros" class="row justify-content-md-center">
           
        </div>
    </main>



    <!-- Modal -->
    <div class="modal fade" id="cursoModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Adicionar curso</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          Confirmar a compra do curso?
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
          <a href="cadastro.html" class="btn btn-primary">Comprar</a>
        </div>
      </div>
    </div>
  </div>

  <div id="box">

  </div>

     <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>

    <script>

        $(document).ready(function(){

            $.ajax({
                type: 'GET', 
                url: 'http://localhost:3000/api/livros',
                timeout: 5000,
                contentType: 'application/json',
                cache: false,
                beforeSend: function() {
                  console.log("solicitando...")
                },
                error: function(error) {
                  console.log(error.statusText)
                },
                success: function(retorno) {
                  console.log(retorno)

                  retorno.forEach(livro => {
                    console.log(livro)
                    let card = obterCard(livro.titulo, livro.paginas, livro.imagem)
                    $("#livros").append(card)
                  }); 
                } 
            }); 

            function obterCard(titulo, paginas, imagem){
              let card = `<div class="col col-lg mt-3">
                            <div class="card">
                                <img src="${imagem}" height="200" alt="${titulo}"/>
                                <div class="card-body">
                                    <h2 class="card-title">${titulo}</h2>
                                    <p class="card-text">Páginas: ${paginas}</p>
                                    <a class="btn btn-primary" data-toggle="modal" data-target="#cursoModal" href="comprar.html">Comprar</a>
                                </div>
                            </div>
                        </div>`
              return card
            }
        })

    </script>

  </body>
</html>